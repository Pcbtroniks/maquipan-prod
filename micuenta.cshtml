@mSeguridad.CookieID()
@using System
@using System.Globalization
@using System.Configuration
@using MySqlConnector
<!DOCTYPE html>
<html lang="es-mx">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow"/>

    <!-- Title -->
    <title>Mi cuenta MAQUIPAN</title>
    <!-- Bootstrap css -->
    <link rel="stylesheet" href="~/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/assets/css/fontawesome.all.min.css" />
    <link rel="stylesheet" href="~/assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="~/assets/css/owl.theme.default.min.css" />
    <link rel="stylesheet" href="~/assets/css/animate.min.css" />
    <link rel="stylesheet" href="~/assets/css/meanmenu.min.css" />
    <link rel="stylesheet" href="~/assets/css/style.css" />
    <link rel="stylesheet" href="~/assets/css/color.css" />
    <link rel="stylesheet" href="~/assets/css/responsive.css" />
    <link rel="apple-touch-icon" sizes="57x57" href="~/assets/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="~/assets/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="~/assets/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="~/assets/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="~/assets/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="~/assets/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="~/assets/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="~/assets/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="~/assets/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="assets/img/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="assets/img/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1021577462753223');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1021577462753223&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Meta Pixel Code -->
    @mAnalitica.AnaliticaGoogle()
</head>

<body>
	<!-- Preloader Area -->
	<div id="preloader">
		<div id="status">
			<img src="assets/img/loader.gif" alt="img">
		</div>
	</div>

	@navegacion.Menu()

	<!-- Banner Area -->
	<section id="common_banner_one" style="background-image: url(/img/secciones/b_nosotros.jpg)">
		<div class="container ">
			<div class="row">
				<div class="col-lg-12">
					<div class="common_banner_text">
						<h2>Mi cuenta</h2>
						<ul>
							<li><a href="~/">Inicio</a></li>
							<li><i class="fas fa-slash"></i></li>
							<li class="active">Mi cuenta</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</section>
	@{
		if (mClientes.ObtenerValorCookie("c") == mClientes.ObtenerValorCookie("c"))
		{
			<!-- My-account-area-Area -->
			using (MySqlConnection CONN = new MySqlConnection(ConfigurationManager.ConnectionStrings["SDNS"].ConnectionString))
			{
				CONN.Open();
				using (MySqlCommand CMD = new MySqlCommand("SELECT * FROM clientes WHERE id = '" + mClientes.ObtenerValorCookie("z1") + "'", CONN))
				{
					MySqlDataReader DATOS = CMD.ExecuteReader();
					while (DATOS.Read())
					{
						<section id="my-account_area" class="ptb-100">
							<div class="container">
								<div class="row">
									<div class="col-sm-12 col-md-12 col-lg-3">
										<!-- Nav tabs -->
										<div class="dashboard_tab_button">
											<ul role="tablist" class="nav flex-column dashboard-list">
												<li>
													<a href="#!" data-bs-toggle="tab" data-bs-target="#dashboard" class=" active">
														<i class="fas fa-tachometer-alt"></i>PANEL PRINCIPAL
													</a>
												</li>
												<li>
													<a href="#!" data-bs-toggle="tab" data-bs-target="#orders">
														<i class="fas fa-cart-arrow-down"></i>ORDENES
													</a>
												</li>
												<li>
													<a href="#!" data-bs-toggle="tab" data-bs-target="#address">
														<i class="fas fa-map-marker-alt"></i>DIRECCIONES
													</a>
												</li>
												<li>
													<a href="#!" data-bs-toggle="tab" data-bs-target="#account-details">
														<i class="fas fa-user"></i>DETALLES DE LA CUENTA
													</a>
												</li>
												<li><a href="~/zcore/clientes/cerrarSesion" class=""><i class="fas fa-sign-out-alt"></i>CERRAR SESIÓN</a></li>
											</ul>
										</div>
									</div>
									<div class="col-sm-12 col-md-12 col-lg-9">
										<!-- Tab panes -->
										<div class="tab-content dashboard_content">
											<div class="tab-pane fade show active" id="dashboard">
												<div class="myaccount-content">
													<h4 class="title">PANEL PRINCIPAL </h4>
													<p>
														¡Hola de nuevo, @DATOS["nombre"]! Nos llena de felicidad contar contigo en nuestra página. ¡Bienvenido/a de nuevo!
													</p>
												</div>
											</div>
											<div class="tab-pane fade" id="orders">
												<div class="myaccount-content">
													<h4 class="title">ORDENES </h4>
													<div class="table_page table-responsive">
														<table>
															@using (MySqlConnection CONN3 = new MySqlConnection(ConfigurationManager.ConnectionStrings["SDNS"].ConnectionString))
															{
																CONN3.Open();
																using (MySqlCommand CMD3 = new MySqlCommand("SELECT * FROM ordenes WHERE id_cliente = '" + mClientes.ObtenerValorCookie("z1") + "' ORDER BY id DESC ", CONN3))
																{
																	MySqlDataReader DATOS3 = CMD3.ExecuteReader();
																	while (DATOS3.Read())
																	{

																		<thead>
																			<tr>
																				<th>Orden no.</th>
																				<th>Estatus</th>
																				<th>Fecha</th>
																				<th>Pago ID</th>
																				<th>Orden</th>
																				<th>Mas info</th>
																			</tr>
																		</thead>
																		<tbody>
																			<tr>
																				<td>@DATOS3["id"]</td>

																				@if (DATOS3["estatus"].ToString() == "POS" && DATOS3["estatus_ventas"].ToString() == "POS")
																				{
																					string aprobada = "Aprobada";
																					<td>@aprobada</td>
																				}
																				else
																				{
																					string pendiente = "Pendiente";
																					<td><a href="~/carrito">@pendiente</a></td>
																				}

																				<td>@Convert.ToDateTime(DATOS3["fecha"].ToString()).ToString("dd MMM yyyy")</td>

																				<td><span class="success">@DATOS3["payment_id"]</span></td>

																				@if (DATOS3["total"].ToString() != "")
																				{
																					<td>$@DATOS3["total"]</td>
																				}
																				else
																				{
																					<td></td>
																				}

																				@if (DATOS3["estatus"].ToString() == "POS" && DATOS3["estatus_ventas"].ToString() == "POS")
																				{
																					<td><a href="~/micuenta_orden/@DATOS3["id"]">Ver orden</a></td>
																				}
																				else
																				{
																					<td></td>
																				}
																			</tr>
																		</tbody>
																	}
																}
															}

														</table>
													</div>
												</div>

											</div>
											<div class="tab-pane" id="address">
												<div class="row">
													<div class="col-12">
														<div class="myaccount-content" style="padding-bottom: 0px">
															<h4 class="title">
																DIRECCIONES
															</h4>
														</div>
													</div>
													@using (MySqlConnection CONN2 = new MySqlConnection(ConfigurationManager.ConnectionStrings["SDNS"].ConnectionString))
													{
														CONN2.Open();
														using (MySqlCommand CMD2 = new MySqlCommand("SELECT * FROM fichas_ubicaciones WHERE id_cliente = '" + mClientes.ObtenerValorCookie("z1") + "'", CONN2))
														{
															MySqlDataReader DATOS2 = CMD2.ExecuteReader();
															while (DATOS2.Read())
															{

																if (DATOS2["nombre"].ToString() != "")
																{
																	<div class="col-lg-6">
																		<div class="myaccount-content">

																			<div class="billing_address">
																				<h5><strong>@DATOS2["nombre"]</strong></h5>
																				<p>
																					@DATOS2["calle"], @DATOS2["interior"], @DATOS2["exterior"] <br>
																					@DATOS2["estado"], @DATOS2["municipio"], @DATOS2["colonia"] <br />
																					@DATOS2["cp"], @DATOS2["cruces"], @DATOS2["observaciones"]
																				</p>
																				<p>Numero de contacto: (123) 123-456789</p>
																				<a href="~/ubicacion_editar/@DATOS2["id"]" class="theme-btn-one bg-black btn_sm">
																					EDITAR DIRECCIÓN
																				</a>

																			</div>
																		</div>
																	</div>
																}

															}
														}
													}
													<div class="row" style="padding: 50px 0px">
														<div class="col-lg-3">
															<a href="~/ubicacion_agregar/@DATOS["id"]" class="theme-btn-one bg-black btn_sm">
																AGREGAR UBICACIÓN
															</a>
														</div>
													</div>
												</div>

											</div>
											<div class="tab-pane fade" id="account-details">
												<div class="myaccount-content">
													<h4 class="title">DETALLES DE LA CUENTA</h4>
													<div class="login_form_container">
														<div class="account_details_form">
															<form action="~/zcore/clientes/credenciales_actualizar" method="post">
																<div class="default-form-box mb-20">
																	<input type="text" name="id" value="@DATOS["id"]" hidden />
																	<label>Nombre</label>
																	<input type="text" name="nombre" class="form-control" value="@DATOS["nombre"]">
																</div>
																<div class="default-form-box mb-20">
																	<label>Apellido materno</label>
																	<input type="text" name="paterno" class="form-control" value="@DATOS["paterno"]">
																</div>
																<div class="default-form-box mb-20">
																	<label>Apellido paterno</label>
																	<input type="text" name="materno" class="form-control" value="@DATOS["materno"]">
																</div>
																<div class="default-form-box mb-20">
																	<label>Correo</label>
																	<input type="text" name="correo" value="@DATOS["correo"]" class="form-control">
																</div>
																<div class="default-form-box mb-20">
																	<label>Contraseña</label>
																	<input name="contra" value="@DATOS["contra"]" class="form-control">
																</div>
																<div class="save_button mt-3">
																	<button type="submit"
																			class="theme-btn-one bg-black btn_sm">
																		ACTUALIZAR
																	</button>
																</div>
															</form>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</section>
					}
				}
			}
		}
		else
		{
			Response.Redirect("~/login");
		}
	}





	<!-- footer Area -->
	@navegacion.Footer()

	<script src="~/assets/js/jquery-3.6.0.min.js"></script>
	<script src="~/assets/js/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/assets/js/owl.carousel.min.js"></script>
	<script src="~/assets/js/meanmenu.min.js"></script>
	<script src="~/assets/js/count.js"></script>
	<script src="~/assets/js/timer.js"></script>
	<script src="~/assets/js/nice-select.min.js"></script>
	<script src="~/assets/js/wow.min.js"></script>
	<script src="~/assets/js/custom.js"></script>
    <script src="~/zcore/js/buscador.js"></script>
</body>
</html>